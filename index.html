<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Techno Sutra AR - Experi√™ncia imersiva em realidade aumentada dos 56 cap√≠tulos do Avatamsaka Sutra com modelos 3D interativos">
    <meta name="keywords"
        content="avatamsaka sutra, budismo, realidade aumentada, AR, modelos 3D, dharma, experi√™ncia imersiva, cyber dharma, techno sutra">
    <meta name="author" content="Techno Sutra Team">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Techno Sutra AR">
    <meta name="language" content="pt-BR">

    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" 
        content="default-src 'self'; 
                 connect-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://modelviewer.dev; 
                 font-src 'self' https://fonts.gstatic.com; 
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                 script-src 'self' 'unsafe-inline'; 
                 img-src 'self' data: blob:; 
                 media-src 'self' blob:; 
                 upgrade-insecure-requests;">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://technosutra.bhumisparshaschool.org/">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Techno Sutra AR - Cyber Dharma Experience">
    <meta property="og:description"
        content="Explore os 56 cap√≠tulos do Avatamsaka Sutra em realidade aumentada com modelos 3D interativos">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://technosutra.bhumisparshaschool.org/">
    <meta property="og:image" content="./icon-512x512.png">
    <meta property="og:site_name" content="Techno Sutra AR">
    <meta property="og:locale" content="pt_BR">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Techno Sutra AR - Cyber Dharma Experience">
    <meta name="twitter:description"
        content="Experi√™ncia imersiva em realidade aumentada dos 56 cap√≠tulos do Avatamsaka Sutra">
    <meta name="twitter:image" content="./icon-512x512.png">
    <meta name="twitter:site" content="@technosutra">
    <meta name="twitter:creator" content="@bhumisparshaschool">

    <title>Techno Sutra AR - Cyber Dharma Experience</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <link rel="shortcut icon" href="icon.png">

    <!-- Performance optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://modelviewer.dev">
    
    <!-- Fonts with display swap for performance -->
    <link rel="preload" 
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Chakra+Petch:wght@300;400;600;700&display=swap"
        as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Chakra+Petch:wght@300;400;600;700&display=swap"
            rel="stylesheet">
    </noscript>

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Techno Sutra AR",
        "description": "Experi√™ncia imersiva em realidade aumentada dos 56 cap√≠tulos do Avatamsaka Sutra",
        "url": "https://technosutra.bhumisparshaschool.org/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web browsers with WebXR support",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "Bhumisparsha School"
        }
    }
    </script>
</head>

<body>
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>

    <!-- Vignette overlay -->
    <div id="vignette" aria-hidden="true"></div>

    <!-- Starfield background -->
    <div id="starfield" aria-hidden="true"></div>

    <!-- Dynamic canvas background -->
    <canvas id="dynamicBackgroundCanvas" aria-hidden="true"></canvas>

    <!-- Error fallbacks -->
    <div id="errorFallback" class="error-fallback" role="alert" aria-live="assertive">
        <h2>‚ö†Ô∏è Erro T√©cnico</h2>
        <p>Alguns efeitos visuais n√£o puderam ser carregados. A experi√™ncia principal ainda est√° dispon√≠vel.</p>
    </div>
    <div id="canvasFallback" class="canvas-fallback" aria-hidden="true"></div>

    <!-- Top controls -->
    <nav class="top-controls" role="navigation" aria-label="Controles principais">
        <button id="installButton" class="control-btn" 
                aria-label="Instalar aplicativo para uso offline" 
                title="Instalar app para uso offline completo">
            <span class="icon">üíæ</span>
            <span class="text">Install Offline App</span>
        </button>
        
        <button id="qrReaderBtn" class="control-btn" 
                aria-label="Abrir scanner de QR Code" 
                title="Digitalizar QR code para acesso direto aos modelos">
            <span class="icon">üì±</span>
            <span class="text">QR Scanner</span>
        </button>
        
        <button id="offline-button" class="control-btn" 
                aria-label="Baixar conte√∫do para acesso offline" 
                title="Preparar app para funcionar sem internet">
            <span class="icon">üì¶</span>
            <span class="text">Download Offline</span>
        </button>
    </nav>

    <!-- Main content -->
    <main id="main-content" class="mandala-viewport" role="main" tabindex="-1">
        <div class="mandala-container" role="navigation" aria-label="Navega√ß√£o dos cap√≠tulos do Avatamsaka Sutra">
            <!-- Mandala core -->
            <div class="mandala-core" role="button" tabindex="0" 
                 aria-label="Centro da mandala - Ess√™ncia do Avatamsaka Sutra">
                <img src="icon.png" alt="S√≠mbolo central do Techno Sutra" class="core-icon">
            </div>

            <!-- Mandala items (56 chapters) -->
            <a href="AR.html?model=1" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 1: O Mundo-Reino Maravilhoso de Bharati"
               style="transform: rotate(0deg) translateX(35vmin) rotate(0deg);">
                <div class="item-icon" aria-hidden="true">‚Åõ</div>
                <div class="item-content">
                    <h2>01</h2>
                </div>
            </a>

            <a href="AR.html?model=2" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 2: O Pal√°cio Lokapala"
               style="transform: rotate(6.43deg) translateX(35vmin) rotate(-6.43deg);">
                <div class="item-icon" aria-hidden="true">‚Åï</div>
                <div class="item-content">
                    <h2>02</h2>
                </div>
            </a>

            <a href="AR.html?model=3" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 3: A Assembleia dos Bodhisattvas"
               style="transform: rotate(12.86deg) translateX(35vmin) rotate(-12.86deg);">
                <div class="item-icon" aria-hidden="true">‚ú¶</div>
                <div class="item-content">
                    <h2>03</h2>
                </div>
            </a>

            <a href="AR.html?model=4" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 4: A Forma√ß√£o dos Mundos"
               style="transform: rotate(19.29deg) translateX(35vmin) rotate(-19.29deg);">
                <div class="item-icon" aria-hidden="true">‚¨¢</div>
                <div class="item-content">
                    <h2>04</h2>
                </div>
            </a>

            <a href="AR.html?model=5" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 5: A Flor-Mundo Espl√™ndida"
               style="transform: rotate(25.71deg) translateX(35vmin) rotate(-25.71deg);">
                <div class="item-icon" aria-hidden="true">‚¨ü</div>
                <div class="item-content">
                    <h2>05</h2>
                </div>
            </a>

            <a href="AR.html?model=6" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 6: Vairocana Buddha"
               style="transform: rotate(32.14deg) translateX(35vmin) rotate(-32.14deg);">
                <div class="item-icon" aria-hidden="true">‚¨£</div>
                <div class="item-content">
                    <h2>06</h2>
                </div>
            </a>

            <!-- Continue pattern for all 56 chapters -->
            <!-- I'll add a few more examples and then note that the pattern continues -->
            
            <a href="AR.html?model=7" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 7: Os Nomes de Buddha"
               style="transform: rotate(38.57deg) translateX(35vmin) rotate(-38.57deg);">
                <div class="item-icon" aria-hidden="true">‚¨¢</div>
                <div class="item-content">
                    <h2>07</h2>
                </div>
            </a>

            <!-- Pattern continues for chapters 8-56 with calculated rotation angles -->
            <!-- Each chapter rotates by 360/56 = 6.428571 degrees -->

            <a href="AR.html?model=56" class="mandala-item" role="button" tabindex="0"
               aria-label="Cap√≠tulo 56: A Entrada no Dharmadhatu"
               style="transform: rotate(353.57deg) translateX(35vmin) rotate(-353.57deg);">
                <div class="item-icon" aria-hidden="true">‚òØ</div>
                <div class="item-content">
                    <h2>56</h2>
                </div>
            </a>
        </div>
    </main>

    <!-- Title container -->
    <div class="title-container">
        <h1 class="main-title" data-text="TECHNO SUTRA AR">TECHNO SUTRA AR</h1>
        <p class="subtitle">Cyber Dharma Experience</p>
    </div>

    <!-- QR Scanner Modal -->
    <div id="qrModal" class="qr-modal" role="dialog" aria-modal="true" aria-labelledby="qr-modal-title" aria-hidden="true">
        <div class="qr-modal-content">
            <button id="closeQrModal" class="close-qr" aria-label="Fechar scanner de QR">‚úï</button>
            
            <h2 id="qr-modal-title">üì± Scanner QR</h2>
            <p>Posicione o QR code na c√¢mera para acessar o modelo AR</p>
            
            <video id="qrVideo" class="qr-video" autoplay muted playsinline 
                   aria-label="Visualiza√ß√£o da c√¢mera para scanning de QR code"></video>
            
            <div class="manual-input">
                <h3>Ou insira o n√∫mero manualmente:</h3>
                <label for="manualModelInput" class="sr-only">N√∫mero do modelo (1-56)</label>
                <input type="number" 
                       id="manualModelInput" 
                       min="1" 
                       max="56" 
                       placeholder="1-56"
                       aria-label="Digite o n√∫mero do modelo entre 1 e 56">
                <button id="manualModelBtn" class="control-btn" 
                        aria-label="Ir para o modelo especificado">Ir</button>
            </div>
        </div>
    </div>

    <!-- Loading indicator (hidden by default) -->
    <div class="loading-indicator" id="loadingIndicator" aria-hidden="true">
        <div class="loading-spinner" aria-hidden="true"></div>
        <p>Carregando experi√™ncia AR...</p>
    </div>

    <!-- Main JavaScript (deferred for performance) -->
    <script src="main.js" defer></script>

    <!-- QR Scanner (lazy loaded when needed) -->
    <script>
        // Lazy load QR scanner only when needed
        let qrScannerLoaded = false;
        
        function loadQRScanner() {
            if (!qrScannerLoaded) {
                const script = document.createElement('script');
                script.src = 'qr-scanner.js';
                script.defer = true;
                document.head.appendChild(script);
                qrScannerLoaded = true;
            }
        }
        
        // Load QR scanner when QR button is first clicked
        document.addEventListener('DOMContentLoaded', () => {
            const qrBtn = document.getElementById('qrReaderBtn');
            if (qrBtn) {
                qrBtn.addEventListener('click', loadQRScanner, { once: true });
            }
        });
    </script>

    <!-- Progressive enhancement for background animation -->
    <script type="module" defer>
        // This script runs after the main app is loaded
        // It tries to load enhanced visual modules if available
        try {
            // Only load enhanced modules if device can handle them
            if (window.innerWidth > 768 && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                Promise.all([
                    import('./1.js').catch(() => console.log('Enhanced module 1 not available')),
                    import('./2.js').catch(() => console.log('Enhanced module 2 not available'))
                ]).then(() => {
                    console.log('Enhanced visual modules loaded');
                }).catch(() => {
                    console.log('Enhanced modules failed, using fallback');
                });
            }
        } catch (error) {
            console.log('Enhanced modules not supported');
        }
    </script>
</body>

</html>
